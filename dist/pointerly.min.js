/*!
 * Pointerly 1.0.1
 * https://pointerly.felipeotto.com/
 * 
 * Copyright 2025 — Felipe Otto
 * Released under the MIT License
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Pointerly",[],e):"object"==typeof exports?exports.Pointerly=e():t.Pointerly=e()}(this,()=>(()=>{"use strict";var t={d:(e,s)=>{for(var r in s)t.o(s,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:s[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};t.d(e,{default:()=>o});class s{constructor(){this.version="1.0.1",this.valid=!1,this.consolePrefix="[Pointerly]",this.debug=!1,this.console=this.createConsole(),this.webGLSupported=this.utils_hasWebGLSupport(),this.webGLSupported||this.console.error("WebGL not supported."),this.inWrapper=!1,this.loaded=!1,this.cursor={type:null,flag:{pos:{x:0,y:0}},pos:{x:0,y:0},elementUnder:null},this._viewport={},this.selector="data-cursor",this.flagSelector="data-cursor-flag",this.systemCursors=!1,this.lastCursorType=null,this.lastCursorFlag=null,this.lastEvent=null,this.fullscreenActive=!1,this.fullscreenActiveMsg=!1,this.isMobileDevice=!1,this.isMobileDeviceMsg=!1,this.eventClassTimeout={move:null,click:null,dblclick:null,mousedown:null,mouseup:null},this.checkFlagSizeTimeout={},this.triggers={init:[],enter:[],move:[],click:[],dblclick:[],mousedown:[],mouseup:[],leave:[],refresh:[],complete:[],updateCursor:[]},this.addEventTrigger={},this.wrapper=document.body,this.domElements=new WeakMap,this.cursorTypes=[],this.cursorFlags=[],this.customRenderList={},this.cursorTypeConfig={},this.cursorFlagConfig={},this.cursorEl=null,this.wrapperCursorTypesEl=null,this.wrapperCursorFlagsEl=null,this.cursorTypeEl={},this.cursorFlagEl={}}}!function(t){t.prototype.init=function(t={}){if(t.debug&&(this.debug=t.debug),this.console.info("Init cursor..."),t.systemCursors&&(this.systemCursors=t.systemCursors),t.on&&(this.addEventTrigger=t.on,this.addEventTrigger&&Object.entries(this.addEventTrigger).forEach(([t,e])=>{"function"==typeof e?this.on(t,e):"object"==typeof e&&"function"==typeof e.callback&&this.on(t,e.callback,e.priority??1e3)})),t.wrapper&&(this.wrapper=this.utils_asArray(t.wrapper)[0]),!this.wrapper)return void this.console.error("Wrapper not found");const e={types:t.types??t.cursors??{},flags:t.flags??{}};if(Object.entries(e).forEach(([t,e])=>{this.prepareCursorMode(t,e)}),0!==this.cursorTypes.length)return this.wrapper.classList.add("pointerly-wrapper"),this.cursorEl=this.createElement("div",{class:"pointerly",insertPrepend:this.wrapper}),this.wrapperCursorTypesEl=this.createElement("div",{class:["pointerly-wrapper-cursor-types"],insert:this.cursorEl}),this.cursorTypes.forEach(t=>{const e=this.createElement("div",{class:["pointerly-type"],attrs:{"data-type":t},insert:this.wrapperCursorTypesEl});this.cursorTypeEl[t]=e,this.helper_customRendering(`types-${t}`,e)}),this.cursorFlags.length&&(this.wrapperCursorFlagsEl=this.createElement("div",{class:"pointerly-wrapper-cursor-flags",insert:this.cursorEl}),this.cursorFlags.forEach(t=>{const e=["pointerly-flag"];this.cursorFlagConfig[t].effect&&e.push(`pointerly-flag-effect-${this.cursorFlagConfig[t].effect}`),"default"!==this.cursorFlagConfig[t].pos&&e.push(`pointerly-flag-pos-${this.cursorFlagConfig[t].pos}`);const s=this.createElement("div",{class:e,attrs:{"data-flag":t},insert:this.wrapperCursorFlagsEl});this.cursorFlagEl[t]=s,this.helper_customRendering(`flags-${t}`,s)})),this.wrapper.setAttribute("data-pointerly-system-cursors",this.systemCursors),this.wrapper.setAttribute("data-pointerly-loaded","true"),this.loaded=!0,this.___prepareAllElements___(),window.addEventListener("resize",()=>{this.utils_sizeViewPort()}),this.utils_sizeViewPort(),this.startEvents(),this.runTriggers("init"),!0;this.console.error("No defined cursor types")},t.prototype.prepareCursorMode=function(t,e){Object.entries(e).forEach(([e,s])=>{"types"==t?this.cursorTypes.push(e):"flags"==t&&this.cursorFlags.push(e),"function"==typeof s||"string"==typeof s||s instanceof Node?this.customRenderList[`${t}-${e}`]=s:"object"==typeof s&&(s.render&&(this.customRenderList[`${t}-${e}`]=s.render),"flags"==t&&(this.cursorFlagConfig[e]={effect:null,pos:"default",smartSize:!1,viewportSafe:!1,size:{width:null,height:null}},s.pos&&["default","left","right","top","bottom"].includes(s.pos)&&(this.cursorFlagConfig[e].pos=s.pos),s.effect&&["chase"].includes(s.effect)&&!this.utils_isSafariBrowser()&&(this.cursorFlagConfig[e].effect=s.effect),s.smartSize&&"boolean"==typeof s.smartSize&&(this.cursorFlagConfig[e].smartSize=s.smartSize),s.viewportSafe&&"boolean"==typeof s.viewportSafe&&(this.cursorFlagConfig[e].viewportSafe=s.viewportSafe)))})},t.prototype.refresh=function(){this.console.info("Refresh cursor..."),this.___prepareAllElements___(),this.runTriggers("refresh"),this.utils_sizeViewPort()},t.prototype.___prepareElement___=function(t){if(t){if(!this.domElements.has(t)){const e=this.helper_guessCursorType(t),s=this.cursorTypes.includes(e)&&"none"!==e,r=this.helper_guessCursorFlag(t);this.domElements.set(t,{type:e??"default",flag:r??null,valid:s})}return this.domElements.get(t)}},t.prototype.___prepareAllElements___=function(){this.utils_asArray("[data-cursor]").forEach(t=>{this.___prepareElement___(t),t.addEventListener("pointerenter",()=>{this.cursor.elementUnder=t,this.updateCursor()})})},t.prototype.destroy=function(){this.debug=!1,this.container=null,this.wrapperFields=null,this.submitResponse=null,this.submitButton=null,this.id=null,this.action="",this.redirect=!1,this.lang="en",this.messages={},this.fieldsSet={},this.errors=null,this.inputCaptcha=null,this.valid=!1},t.prototype.complete=function(){this.console.info("Complete"),this.runTriggers("complete")}}(s),function(t){t.prototype.moveCursor=function(){const{x:t,y:e}=this.cursor.pos,s=this.cursor.flag?.current,r=this.cursorFlagConfig[s]??{};let i,o;r&&r.effect&&(i=r.effect,"chase"==i&&(o=.1));const n=()=>{this.cursorFlags.length?(this.wrapperCursorTypesEl.style.transform=`translate3d(${t}px, ${e}px, 0)`,this.wrapperCursorFlagsEl.style.transform=`translate3d(${t}px, ${e}px, 0)`):this.cursorEl.style.transform=`translate3d(${t}px, ${e}px, 0)`;Math.sqrt(t*t+e*e)>.5&&requestAnimationFrame(n)};n()},t.prototype.updateCursor=function(){if(this.utils_checkFullscreen(),this.fullscreenActive&&(this.lastCursorFlag=null,this.lastCursorType=null),this.utils_checkIsMobileDevice(),!this.cursor.elementUnder)return;const t=this.domElements.get(this.cursor.elementUnder);this.lastCursorFlag!==t.flag&&this.updateCursorFlag(t.flag),this.lastCursorType!==t.type&&this.updateCursorType(t.type,t.valid),this.runTriggers("updateCursor",this.cursor)},t.prototype.updateCursorType=function(t,e){this.lastCursorType=t,this.cursor.type=t,Object.values(this.cursorTypeEl).forEach(t=>{t instanceof Element&&t.classList.remove("current")}),e&&!1===this.fullscreenActive&&!1===this.isMobileDevice&&this.cursorTypeEl[t]instanceof Element?(this.wrapper.setAttribute("data-pointerly-custom",t),this.wrapper.setAttribute("data-pointerly-system",""),this.wrapper.setAttribute("data-pointerly-valid","true"),this.cursorTypeEl[t].classList.add("current"),this.cursorEl.setAttribute("data-cursor-current",t)):(this.wrapper.setAttribute("data-pointerly-custom",""),this.wrapper.setAttribute("data-pointerly-system",t),this.wrapper.setAttribute("data-pointerly-valid","false"),this.cursorEl.setAttribute("data-cursor-current",""))}}(s),function(t){t.prototype.updateCursorFlag=function(t){if(this.lastCursorFlag=t,this.cursor.flag.current=t,Object.values(this.cursorFlagEl).forEach(t=>{t instanceof Element&&t.classList.remove("current")}),!1===this.fullscreenActive&&!1===this.isMobileDevice&&this.cursorFlagEl[t]instanceof Element){this.cursorFlagEl[t].classList.add("current");const e=()=>{const e=this.cursorFlagEl[t],s=e.getBoundingClientRect(),r=window.getComputedStyle(e).transform;let i=0,o=0;if(r&&"none"!==r){const t=r.match(/matrix\(([^)]+)\)/);if(t){const e=t[1].split(",").map(parseFloat);6===e.length&&(i=e[4],o=e[5])}}this.cursorFlagConfig[t].size={width:s.width+i,height:s.height+o},this.console.log("[Size Updated]",this.cursorFlagConfig[t])};!0===this.cursorFlagConfig[t].smartSize?e():this.checkFlagSizeTimeout[t]||(this.checkFlagSizeTimeout[t]=setTimeout(()=>{e()},500))}}}(s),function(t){t.prototype.startEvents=function(){this.wrapper.addEventListener("pointermove",t=>{this.loaded&&(this.enter(t),this.move(t))}),this.wrapper.addEventListener("click",t=>{this.loaded&&this.click(t)}),this.wrapper.addEventListener("dblclick",t=>{this.loaded&&this.doubleClick(t)}),this.wrapper.addEventListener("mousedown",t=>{this.loaded&&this.mouseDown(t)}),this.wrapper.addEventListener("mouseup",t=>{this.loaded&&this.mouseUp(t)}),this.wrapper.addEventListener("mouseleave",()=>{this.loaded&&this.leave()})},t.prototype.enter=function(t){this.inWrapper||(this.console.info("Enter"),this.inWrapper=!0,this.cursorEl.classList.add("active"),this.runTriggers("enter"))},t.prototype.move=function(t){const e=this.getEventData(t);this.runTriggers("move",e),this.setLastEvent("move"),this.cursor.pos.x=e.pos.x,this.cursor.pos.y=e.pos.y,this.cursor.elementUnder=e.elementUnder,this.moveCursor(),this.___prepareElement___(this.cursor.elementUnder),this.updateCursor()},t.prototype.leave=function(){this.console.info("Leave"),this.inWrapper=!1,this.cursorEl.classList.remove("active"),this.runTriggers("leave")},t.prototype.mouseUp=function(t){const e=this.getEventData(t);this.console.info("Mouse up"),this.setLastEvent("mouseup"),this.runTriggers("mouseup",e)},t.prototype.mouseDown=function(t){const e=this.getEventData(t);this.console.info("Mouse down"),this.setLastEvent("mousedown"),this.runTriggers("mousedown",e)},t.prototype.doubleClick=function(t){const e=this.getEventData(t);this.console.info("Double click"),this.setLastEvent("dblclick"),this.runTriggers("dblclick",e)},t.prototype.click=function(t){const e=this.getEventData(t);this.console.info("Click"),this.setLastEvent("click"),this.runTriggers("click",e)},t.prototype.getEventData=function(t){return{event:t,pos:{x:t.clientX,y:t.clientY},elementUnder:document.elementFromPoint(t.clientX,t.clientY)}},t.prototype.setLastEvent=function(t){let e;"move"==t?e="moving":"click"==t?e="clicked":"dblclick"==t?e="doubleclick":"mousedown"==t?e="mousedown":"mouseup"==t&&(e="mouseup"),this.lastEvent!=t&&(this.wrapper.setAttribute("data-pointerly-last-event",t),this.lastEvent=t),this.cursorEl.classList.add(e),this.eventClassTimeout[t]&&clearTimeout(this.eventClassTimeout[t]),this.eventClassTimeout[t]=setTimeout(()=>{this.cursorEl.classList.remove(e),this.eventClassTimeout[t]=null},100)}}(s),function(t){t.prototype.on=function(t,e,s=1e3){"function"==typeof e&&this.triggers[t]?this.triggers[t].push({callback:e,priority:s}):console.error("Callback deve ser uma função e o estágio deve ser válido (initial, leave, enter).")},t.prototype.runTriggers=async function(t,e=null){if(this.triggers[t]){this.triggers[t].sort((t,e)=>t.priority-e.priority),this.debug&&this.triggers[t].forEach((t,e)=>{});for(const{callback:s,priority:r}of this.triggers[t])try{await s(e)}catch(e){this.debug&&(console.error(`Erro ao executar trigger no estágio "${t}"`),console.error("Função:",s.name||"Função anônima"),console.error(`Prioridade: ${r}`),console.error(`Conteúdo da função: ${s.toString()}`),console.error("Erro:",e))}}else console.error(`Estágio inválido: ${t}`)}}(s),function(t){t.prototype.createConsole=function(){if(!this.debug)return{log:()=>{},info:()=>{},warn:()=>{},error:()=>{},table:()=>{}};const t=this.consolePrefix;return{log:(...e)=>console.log(t,...e),info:(...e)=>console.info(t,...e),warn:(...e)=>console.warn(t,...e),error:(...e)=>console.error(t,...e),table:(...e)=>{const s=e.pop();console.log(t,...e),console.table(s)}}}}(s),function(t){t.prototype.utils_hasWebGLSupport=function(){try{const t=document.createElement("canvas");return!(!window.WebGLRenderingContext||!t.getContext("webgl")&&!t.getContext("experimental-webgl"))}catch(t){return!1}},t.prototype.utils_checkFullscreen=function(){this.fullscreenActive=this.utils_isFullscreenActive(),!0===this.fullscreenActive?(this.console.log("Fullscreen active"),this.fullscreenActiveMsg=!0):this.fullscreenActiveMsg=!1},t.prototype.utils_checkIsMobileDevice=function(){this.isMobileDevice=this.utils_isMobileDevice(),this.isMobileDevice&&!this.isMobileDeviceMsg?(this.console.log("Sorry, not compatible with mobile devices"),this.isMobileDeviceMsg=!0):this.isMobileDeviceMsg=!1},t.prototype.utils_isFullscreenActive=function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.webkitEnterFullscreen||document.mozFullScreenElement||document.msFullscreenElement)},t.prototype.utils_isSafariBrowser=function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},t.prototype.utils_sizeViewPort=function(){this._viewport={width:window.innerWidth,height:window.innerHeight}},t.prototype.createElement=function(t,e={}){const s=document.createElement(t);if(e.class){const t=Array.isArray(e.class)?e.class:e.class.trim().split(/\s+/);s.classList.add(...t)}return e.attrs&&Object.entries(e.attrs).forEach(([t,e])=>s.setAttribute(t,e)),e.text&&(s.textContent=e.text),e.html&&(s.innerHTML=e.html),e.insert&&e.insert.appendChild(s),e.insertPrepend&&e.insertPrepend.prepend(s),s},t.prototype.utils_isMobileDevice=function(){return/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Windows Phone|Kindle|Silk|Mobile/i.test(navigator.userAgent)},t.prototype.utils_asArray=function(t,e=document,s=!1){if(t instanceof HTMLElement)return[t];const r=t=>"string"==typeof t,i=Array.isArray,o=(t,s=!1)=>{t.reduce((t,n)=>(i(n)?t.push(...o(n,s)):!s&&r(n)?t.push(...toArray(n,e,s)):t.push(n),t),[])};if(r(t)&&!s)try{return Array.from(e.querySelectorAll(t))}catch(t){return[]}return i(t)?o(t,s):(n=t)&&"number"==typeof n.length&&"function"!=typeof n?Array.from(t):t?[t]:[];var n}}(s),function(t){t.prototype.helper_guessCursorFlag=function(t){if(!t)return;return t.getAttribute(this.flagSelector)??null},t.prototype.helper_guessCursorType=function(t){if(!t)return;const e=t.getAttribute(this.selector)??null;if(e)return"auto"===e||"initial"===e?"default":e;const s=t.tagName.toLowerCase(),r=t.getAttribute("type");if("input"===s){if(["text","email","search","url","tel","password"].includes(r))return"text";if(["submit","button","checkbox","radio","range","file","range"].includes(r))return"pointer"}if("textarea"===s)return"text";if("button"===s||t.onclick)return"pointer";if("a"===s&&t.hasAttribute("href"))return"pointer";return["p","h1","h2","h3","h4","h5","h6","span","strong","em","b","i","u","small","mark","label"].includes(s)||t.isContentEditable?"text":"default"},t.prototype.helper_customRendering=function(t,e,s={}){if(!t||!e)return null;if(!this.customRenderList[t]||"string"!=typeof t)return null;const r=this.customRenderList[t],i=this.helper_resolveRenderOutput(r,this,s);if(!i)return;let o;return i instanceof DocumentFragment?(o=Array.from(i.childNodes),e.appendChild(i)):Array.isArray(i)?(o=i,e.append(...i)):i instanceof Node&&(o=[i],e.appendChild(i)),o?.[0]||null},t.prototype.helper_resolveRenderOutput=function(t,e={},s={}){if("function"==typeof t){const r=t.call(e,s);return this.helper_resolveRenderOutput(r,e,s)}if(t instanceof Node)return t;if("string"==typeof t){const e=t.trim();if(/^<.+?>/.test(e)){const t=document.createElement("div");t.innerHTML=e;const s=document.createDocumentFragment();for(;t.firstChild;)s.appendChild(t.firstChild);return s}return document.createTextNode(e)}return null}}(s);const r=new s,i={name:"Pointerly",version:r.version,init:(...t)=>r.init(...t),refresh:(...t)=>r.refresh(...t),_instance:r};s._instance=r,"undefined"!=typeof window&&(window.Pointerly=i);const o=i;return e=e.default})());