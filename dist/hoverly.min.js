!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Hoverly",[],t):"object"==typeof exports?exports.Hoverly=t():e.Hoverly=t()}(this,()=>(()=>{"use strict";var e={d:(t,s)=>{for(var r in s)e.o(s,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:s[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};e.d(t,{default:()=>o});class s{constructor(){this.valid=!1,this.consolePrefix="[Hoverly]",this.debug=!1,this.console=this.createConsole(),this.webGLSupported=this.hasWebGLSupport(),this.webGLSupported||this.console.error("WebGL not supported."),this.inWrapper=!1,this.loaded=!1,this.cursor={type:null,flag:{pos:{x:0,y:0}},pos:{x:0,y:0},elementUnder:null},this._viewport={},this.selector="data-cursor",this.flagSelector="data-cursor-flag",this.systemCursors=!1,this.lastCursorType=null,this.lastCursorFlag=null,this.lastEvent=null,this.fullscreenActive=!1,this.fullscreenActiveMsg=!1,this.isMobileDevice=!1,this.isMobileDeviceMsg=!1,this.eventClassTimeout={move:null,click:null,dblclick:null,mousedown:null,mouseup:null},this.checkFlagSizeTimeout={},this.triggers={init:[],enter:[],move:[],click:[],dblclick:[],mousedown:[],mouseup:[],leave:[],refresh:[],complete:[],updateCursor:[]},this.addEventTrigger={},this.wrapper=document.body,this.domElements=new WeakMap,this.cursorTypes=[],this.cursorFlags=[],this.customRenderList={},this.cursorTypeConfig={},this.cursorFlagConfig={},this.cursorEl=null,this.wrapperCursorTypesEl=null,this.wrapperCursorFlagsEl=null,this.cursorTypeEl={},this.cursorFlagEl={}}}!function(e){e.prototype.prepareCursorMode=function(e,t){Object.entries(t).forEach(([t,s])=>{"types"==e?this.cursorTypes.push(t):"flags"==e&&this.cursorFlags.push(t),"function"==typeof s||"string"==typeof s||s instanceof Node?this.customRenderList[`${e}-${t}`]=s:"object"==typeof s&&(s.render&&(this.customRenderList[`${e}-${t}`]=s.render),"flags"==e&&(this.cursorFlagConfig[t]={effect:null,pos:"default",smartSize:!1,viewportSafe:!1,size:{width:null,height:null}},s.pos&&["default","left","right","top","bottom"].includes(s.pos)&&(this.cursorFlagConfig[t].pos=s.pos),s.effect&&["chase"].includes(s.effect)&&!this.isSafariBrowser()&&(this.cursorFlagConfig[t].effect=s.effect),s.smartSize&&"boolean"==typeof s.smartSize&&(this.cursorFlagConfig[t].smartSize=s.smartSize),s.viewportSafe&&"boolean"==typeof s.viewportSafe&&(this.cursorFlagConfig[t].viewportSafe=s.viewportSafe)))})},e.prototype.init=function(e={}){if(e.debug&&(this.debug=e.debug),this.console.info("Init cursor..."),e.systemCursors&&(this.systemCursors=e.systemCursors),e.on&&(this.addEventTrigger=e.on,this.addEventTrigger&&Object.entries(this.addEventTrigger).forEach(([e,t])=>{"function"==typeof t?this.on(e,t):"object"==typeof t&&"function"==typeof t.callback&&this.on(e,t.callback,t.priority??1e3)})),e.wrapper&&(this.wrapper=this.asArray(e.wrapper)[0]),!this.wrapper)return void this.console.error("Wrapper not found");const t={types:e.types??e.cursors??{},flags:e.flags??{}};if(Object.entries(t).forEach(([e,t])=>{this.prepareCursorMode(e,t)}),0!==this.cursorTypes.length)return this.wrapper.classList.add("hoverly-wrapper"),this.cursorEl=this.createElement("div",{class:"hoverly",insertPrepend:this.wrapper}),this.wrapperCursorTypesEl=this.createElement("div",{class:["hoverly-wrapper-cursor-types"],insert:this.cursorEl}),this.cursorTypes.forEach(e=>{const t=this.createElement("div",{class:["hoverly-type"],attrs:{"data-type":e},insert:this.wrapperCursorTypesEl});this.cursorTypeEl[e]=t,this.customRendering(`types-${e}`,t)}),this.cursorFlags.length&&(this.wrapperCursorFlagsEl=this.createElement("div",{class:"hoverly-wrapper-cursor-flags",insert:this.cursorEl}),this.cursorFlags.forEach(e=>{const t=["hoverly-flag"];this.cursorFlagConfig[e].effect&&t.push(`hoverly-flag-effect-${this.cursorFlagConfig[e].effect}`),"default"!==this.cursorFlagConfig[e].pos&&t.push(`hoverly-flag-pos-${this.cursorFlagConfig[e].pos}`);const s=this.createElement("div",{class:t,attrs:{"data-flag":e},insert:this.wrapperCursorFlagsEl});this.cursorFlagEl[e]=s,this.customRendering(`flags-${e}`,s)})),this.wrapper.setAttribute("data-hoverly-system-cursors",this.systemCursors),this.wrapper.setAttribute("data-hoverly-loaded","true"),this.loaded=!0,this.___prepareAllElements___(),window.addEventListener("resize",()=>{this.checkSizeViewPort()}),this.checkSizeViewPort(),this.startEvents(),this.runTriggers("init"),!0;this.console.error("No defined cursor types")},e.prototype.checkSizeViewPort=function(){this._viewport={width:window.innerWidth,height:window.innerHeight}},e.prototype.refresh=function(){this.console.info("Refresh cursor..."),this.___prepareAllElements___(),this.runTriggers("refresh"),this.checkSizeViewPort()},e.prototype.___prepareElement___=function(e){if(e){if(!this.domElements.has(e)){const t=this.guessCursorType(e),s=this.cursorTypes.includes(t)&&"none"!==t,r=this.guessCursorFlag(e);this.domElements.set(e,{type:t??"default",flag:r??null,valid:s})}return this.domElements.get(e)}},e.prototype.___prepareAllElements___=function(){this.asArray("[data-cursor]").forEach(e=>{this.___prepareElement___(e),e.addEventListener("pointerenter",()=>{this.cursor.elementUnder=e,this.updateCursor()})})},e.prototype.startEvents=function(){this.wrapper.addEventListener("pointermove",e=>{this.loaded&&(this.enter(e),this.move(e))}),this.wrapper.addEventListener("click",e=>{this.loaded&&this.click(e)}),this.wrapper.addEventListener("dblclick",e=>{this.loaded&&this.doubleClick(e)}),this.wrapper.addEventListener("mousedown",e=>{this.loaded&&this.mouseDown(e)}),this.wrapper.addEventListener("mouseup",e=>{this.loaded&&this.mouseUp(e)}),this.wrapper.addEventListener("mouseleave",()=>{this.loaded&&this.leave()})},e.prototype.enter=function(e){this.inWrapper||(this.console.info("Enter"),this.inWrapper=!0,this.cursorEl.classList.add("active"),this.runTriggers("enter"))},e.prototype.move=function(e){const t=this.getEventData(e);this.runTriggers("move",t),this.setLastEvent("move"),this.cursor.pos.x=t.pos.x,this.cursor.pos.y=t.pos.y,this.cursor.elementUnder=t.elementUnder,this.moveCursor(),this.___prepareElement___(this.cursor.elementUnder),this.updateCursor()},e.prototype.moveCursor=function(){const{x:e,y:t}=this.cursor.pos,s=this.cursor.flag?.current,r=this.cursorFlagConfig[s]??{};let i,o;r&&r.effect&&(i=r.effect,"chase"==i&&(o=.1));const n=()=>{this.cursorFlags.length?(this.wrapperCursorTypesEl.style.transform=`translate3d(${e}px, ${t}px, 0)`,this.wrapperCursorFlagsEl.style.transform=`translate3d(${e}px, ${t}px, 0)`):this.cursorEl.style.transform=`translate3d(${e}px, ${t}px, 0)`;Math.sqrt(e*e+t*t)>.5&&requestAnimationFrame(n)};n()},e.prototype.updateCursor=function(){if(this.checkFullscreen(),this.fullscreenActive&&(this.lastCursorFlag=null,this.lastCursorType=null),this.checkIsMobileDevice(),!this.cursor.elementUnder)return;const e=this.domElements.get(this.cursor.elementUnder);this.lastCursorFlag!==e.flag&&this.updateCursorFlag(e.flag),this.lastCursorType!==e.type&&this.updateCursorType(e.type,e.valid),this.runTriggers("updateCursor",this.cursor)},e.prototype.updateCursorType=function(e,t){this.lastCursorType=e,this.cursor.type=e,Object.values(this.cursorTypeEl).forEach(e=>{e instanceof Element&&e.classList.remove("current")}),t&&!1===this.fullscreenActive&&!1===this.isMobileDevice&&this.cursorTypeEl[e]instanceof Element?(this.wrapper.setAttribute("data-hoverly-custom",e),this.wrapper.setAttribute("data-hoverly-system",""),this.wrapper.setAttribute("data-hoverly-valid","true"),this.cursorTypeEl[e].classList.add("current"),this.cursorEl.setAttribute("data-cursor-current",e)):(this.wrapper.setAttribute("data-hoverly-custom",""),this.wrapper.setAttribute("data-hoverly-system",e),this.wrapper.setAttribute("data-hoverly-valid","false"),this.cursorEl.setAttribute("data-cursor-current",""))},e.prototype.updateCursorFlag=function(e){if(this.lastCursorFlag=e,this.cursor.flag.current=e,Object.values(this.cursorFlagEl).forEach(e=>{e instanceof Element&&e.classList.remove("current")}),!1===this.fullscreenActive&&!1===this.isMobileDevice&&this.cursorFlagEl[e]instanceof Element){this.cursorFlagEl[e].classList.add("current");const t=()=>{const t=this.cursorFlagEl[e],s=t.getBoundingClientRect(),r=window.getComputedStyle(t).transform;let i=0,o=0;if(r&&"none"!==r){const e=r.match(/matrix\(([^)]+)\)/);if(e){const t=e[1].split(",").map(parseFloat);6===t.length&&(i=t[4],o=t[5])}}this.cursorFlagConfig[e].size={width:s.width+i,height:s.height+o},this.console.log("[Size Updated]",this.cursorFlagConfig[e])};!0===this.cursorFlagConfig[e].smartSize?t():this.checkFlagSizeTimeout[e]||(this.checkFlagSizeTimeout[e]=setTimeout(()=>{t()},500))}},e.prototype.leave=function(){this.console.info("Leave"),this.inWrapper=!1,this.cursorEl.classList.remove("active"),this.runTriggers("leave")},e.prototype.getEventData=function(e){return{event:e,pos:{x:e.clientX,y:e.clientY},elementUnder:document.elementFromPoint(e.clientX,e.clientY)}},e.prototype.setLastEvent=function(e){let t;"move"==e?t="moving":"click"==e?t="clicked":"dblclick"==e?t="doubleclick":"mousedown"==e?t="mousedown":"mouseup"==e&&(t="mouseup"),this.lastEvent!=e&&(this.wrapper.setAttribute("data-hoverly-last-event",e),this.lastEvent=e),this.cursorEl.classList.add(t),this.eventClassTimeout[e]&&clearTimeout(this.eventClassTimeout[e]),this.eventClassTimeout[e]=setTimeout(()=>{this.cursorEl.classList.remove(t),this.eventClassTimeout[e]=null},100)},e.prototype.validateCustomRendering=function(e,t){return("function"==typeof e||"string"==typeof e||e instanceof Node)&&(this.customRenderList[t]=e,!0)},e.prototype.customRendering=function(e,t,s={}){if(!e||!t)return null;if(!this.customRenderList[e]||"string"!=typeof e)return null;const r=this.customRenderList[e],i=this.resolveRenderOutput(r,this,s);if(!i)return;let o;return i instanceof DocumentFragment?(o=Array.from(i.childNodes),t.appendChild(i)):Array.isArray(i)?(o=i,t.append(...i)):i instanceof Node&&(o=[i],t.appendChild(i)),o?.[0]||null},e.prototype.resolveRenderOutput=function(e,t={},s={}){if("function"==typeof e){const r=e.call(t,s);return this.resolveRenderOutput(r,t,s)}if(e instanceof Node)return e;if("string"==typeof e){const t=e.trim();if(/^<.+?>/.test(t)){const e=document.createElement("div");e.innerHTML=t;const s=document.createDocumentFragment();for(;e.firstChild;)s.appendChild(e.firstChild);return s}return document.createTextNode(t)}return null},e.prototype.guessCursorFlag=function(e){if(!e)return;return e.getAttribute(this.flagSelector)??null},e.prototype.guessCursorType=function(e){if(!e)return;const t=e.getAttribute(this.selector)??null;if(t)return"auto"===t||"initial"===t?"default":t;const s=e.tagName.toLowerCase(),r=e.getAttribute("type");if("input"===s){if(["text","email","search","url","tel","password"].includes(r))return"text";if(["submit","button","checkbox","radio","range","file","range"].includes(r))return"pointer"}if("textarea"===s)return"text";if("button"===s||e.onclick)return"pointer";if("a"===s&&e.hasAttribute("href"))return"pointer";return["p","h1","h2","h3","h4","h5","h6","span","strong","em","b","i","u","small","mark","label"].includes(s)||e.isContentEditable?"text":"default"},e.prototype.hasWebGLSupport=function(){try{const e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(e){return!1}},e.prototype.checkFullscreen=function(){this.fullscreenActive=this.isFullscreenActive(),!0===this.fullscreenActive?(this.console.log("Fullscreen active"),this.fullscreenActiveMsg=!0):this.fullscreenActiveMsg=!1},e.prototype.checkIsMobileDevice=function(){this.isMobileDevice=this.___isMobileDevice___(),this.isMobileDevice&&!this.isMobileDeviceMsg?(this.console.log("Sorry, not compatible with mobile devices"),this.isMobileDeviceMsg=!0):this.isMobileDeviceMsg=!1},e.prototype.isFullscreenActive=function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.webkitEnterFullscreen||document.mozFullScreenElement||document.msFullscreenElement)},e.prototype.delay=function(e){return new Promise(t=>setTimeout(t,e))},e.prototype.isSafariBrowser=function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},e.prototype.createElement=function(e,t={}){const s=document.createElement(e);if(t.class){const e=Array.isArray(t.class)?t.class:t.class.trim().split(/\s+/);s.classList.add(...e)}return t.attrs&&Object.entries(t.attrs).forEach(([e,t])=>s.setAttribute(e,t)),t.text&&(s.textContent=t.text),t.html&&(s.innerHTML=t.html),t.insert&&t.insert.appendChild(s),t.insertPrepend&&t.insertPrepend.prepend(s),s},e.prototype.___isMobileDevice___=function(){return/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Windows Phone|Kindle|Silk|Mobile/i.test(navigator.userAgent)},e.prototype.asArray=function(e,t=document,s=!1){if(e instanceof HTMLElement)return[e];const r=e=>"string"==typeof e,i=Array.isArray,o=(e,s=!1)=>{e.reduce((e,n)=>(i(n)?e.push(...o(n,s)):!s&&r(n)?e.push(...toArray(n,t,s)):e.push(n),e),[])};if(r(e)&&!s)try{return Array.from(t.querySelectorAll(e))}catch(e){return[]}return i(e)?o(e,s):(n=e)&&"number"==typeof n.length&&"function"!=typeof n?Array.from(e):e?[e]:[];var n},e.prototype.destroy=function(){this.debug=!1,this.container=null,this.wrapperFields=null,this.submitResponse=null,this.submitButton=null,this.id=null,this.action="",this.redirect=!1,this.lang="en",this.messages={},this.fieldsSet={},this.errors=null,this.inputCaptcha=null,this.valid=!1},e.prototype.createConsole=function(){if(!this.debug)return{log:()=>{},info:()=>{},warn:()=>{},error:()=>{},table:()=>{}};const e=this.consolePrefix;return{log:(...t)=>console.log(e,...t),info:(...t)=>console.info(e,...t),warn:(...t)=>console.warn(e,...t),error:(...t)=>console.error(e,...t),table:(...t)=>{const s=t.pop();console.log(e,...t),console.table(s)}}},e.prototype.complete=function(){this.console.info("Complete"),this.runTriggers("complete")},e.prototype.mouseUp=function(e){const t=this.getEventData(e);this.console.info("Mouse up"),this.setLastEvent("mouseup"),this.runTriggers("mouseup",t)},e.prototype.mouseDown=function(e){const t=this.getEventData(e);this.console.info("Mouse down"),this.setLastEvent("mousedown"),this.runTriggers("mousedown",t)},e.prototype.doubleClick=function(e){const t=this.getEventData(e);this.console.info("Double click"),this.setLastEvent("dblclick"),this.runTriggers("dblclick",t)},e.prototype.click=function(e){const t=this.getEventData(e);this.console.info("Click"),this.setLastEvent("click"),this.runTriggers("click",t)}}(s),function(e){e.prototype.on=function(e,t,s=1e3){"function"==typeof t&&this.triggers[e]?this.triggers[e].push({callback:t,priority:s}):console.error("Callback deve ser uma função e o estágio deve ser válido (initial, leave, enter).")},e.prototype.runTriggers=async function(e,t=null){if(this.triggers[e]){this.triggers[e].sort((e,t)=>e.priority-t.priority),this.debug&&this.triggers[e].forEach((e,t)=>{});for(const{callback:s,priority:r}of this.triggers[e])try{await s(t)}catch(t){this.debug&&(console.error(`Erro ao executar trigger no estágio "${e}"`),console.error("Função:",s.name||"Função anônima"),console.error(`Prioridade: ${r}`),console.error(`Conteúdo da função: ${s.toString()}`),console.error("Erro:",t))}}else console.error(`Estágio inválido: ${e}`)}}(s);const r=new s,i={init:(...e)=>r.init(...e),refresh:(...e)=>r.refresh(...e),_instance:r};s._instance=r,"undefined"!=typeof window&&(window.Hoverly=i);const o=i;return t=t.default})());